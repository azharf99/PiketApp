{% extends 'reports/base-report.html' %}

{% block content %}
<main class="p-4 overflow-auto mb-2">
  <h1 class="px-2 text-2xl font-bold text-blue-500 dark:text-white">Report Quick Input View</h1>
  <!-- Breadcrumb -->
  <div class="flex items-center gap-2">
    <a href="{% url 'dashboard' %}" class="pl-2">Dashboard</a>
    <p class="text-2xl">
      &triangleright;
    </p>
    <a href="{% url 'report-list' %}">Report List</a>
    <p class="text-2xl">
      &triangleright;
    </p>
    <a href="{% url 'report-quick-create-v2' %}">Report Quick Input View</a>
  </div>

  {% if messages %}
  {% for message in messages %}
  <div class="m-2 flex justify-center">
    <div
      class="flex items-center p-4 mb-4 mx-2 text-sm text-green-800 border border-green-300 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400 dark:border-green-800"
      role="alert">
      <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
        fill="currentColor" viewBox="0 0 20 20">
        <path
          d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z" />
      </svg>
      <span class="sr-only">Info</span>
      <div>
        <span class="font-medium">Success! {{message.message}}</span>
      </div>
    </div>
  </div>
  {% endfor %}
  {% endif %}


  <div class="block md:flex justify-center m-2 gap-2 text-balance text-center">
    <a href="{% url 'report-download' %}">
      <p class="p-1 px-2 my-2 bg-green-500 text-white rounded-md font-semibold">&#128196; Export to Excel</p>
    </a>
    <a href="{% url 'dashboard-teachers' %}">
      <p class="p-1 px-2 my-2 bg-blue-500 text-white rounded-md font-semibold">&#128196; Rekap Kehadiran Guru</p>
    </a>
  </div>
  <div class="p-2 flex justify-center items-center">
    <form action="{% url 'report-quick-create-v2' %}" method="get" class="flex justify-start items-center flex-wrap">
      <label for="query_date">Tanggal</label>
      <input type="date" name="query_date" id="query_date" {% if query_date %} value="{{query_date}}" {% endif %}
      class="border border-blue-500 rounded-md py-1 m-1 px-2 text-black">
      <input type="submit" value="Cari Data"
      class="p-2 m-1 rounded-lg text-white bg-indigo-500 text-xs cursor-pointer">
    </form>
  </div>
  <div class="p-2 flex justify-center items-center">
  <p class="my-2 font-bold">Daftar Piket {{query_date|date:"l, d F Y"}}</p>
  </div>

  <div class="grid grid-cols-1">
    <!-- Analytics Table -->
    <div class="p-4 mx-2 my-4 bg-white dark:bg-slate-800 rounded-md shadow-lg overflow-auto relative">

      <table class="table-auto border-collapse w-full">
        <caption class="my-2 font-bold">Daftar Laporan {{query_date|date:"l, d F Y"}}</caption>
        <thead>
          <th class="p-2 border border-gray-400">Jam Ke</th>
          {% for object in class %}
          <th class="p-2 border border-gray-400">{{object}}</th>
          {% endfor %}
          <th class="p-2 border border-gray-400">Petugas Piket</th>
        </thead>
        <tbody>
          {% for data in grouped_data %}
          {% if forloop.counter == 6 or forloop.counter == 8 %}
          <tr>
            <td class="p-2 border border-gray-400 text-center font-bold" colspan="17">Istirahat</td>
          </tr>
          {% endif %}
          <tr>
            <td class="p-2 border border-gray-400 text-center">{{forloop.counter}}</td>
            {% for object in data %}
            <td class="p-2 border border-gray-400 text-center">
              {% if object.status == "Hadir" %}
              <a href="{% url 'report-update-v2' object.id %}" id="{{object.id}}">
                <p class="bg-green-500 p-1 rounded-md text-sm text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32 flex gap-4 justify-end items-center">{{object.status}} <span class="text-md p-1 bg-green-500 border-2 border-white rounded-full">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
                </svg></span>
                </p>
              </a>
              {% elif object.status == "Sakit" %}
              <a href="{% url 'report-update-v2' object.id %}" id="{{object.id}}">
              <p class="bg-yellow-600 p-1 rounded-md text-sm text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32 flex gap-4 justify-end items-center">{{object.status}} <span class="text-md p-1 bg-yellow-600 border-2 border-white rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
              </svg></span></p>
              </a>
              {% elif object.status == "Izin" %}
              <a href="{% url 'report-update-v2' object.id %}" id="{{object.id}}">
              <p class="bg-lime-500 p-1 rounded-md text-sm text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32 flex gap-4 justify-end items-center">{{object.status}} <span class="text-md p-1 bg-lime-500 border-2 border-white rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
              </svg></span></p>
              </a>
              {% elif object.status == "Tanpa Keterangan" %}
              <a href="{% url 'report-update-v2' object.id %}" id="{{object.id}}">
              <p class="bg-red-500 p-1 rounded-md text-sm text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32 flex gap-4 justify-end items-center">Alpha <span class="text-md p-1 bg-red-500 border-2 border-white rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
              </svg></span></p>
              </a>
              {% endif %}
              {% if object.no_status %}
              <span class="bg-red-500 py-1 px-2 rounded-md text-sm text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32">Kosong</span>
              {% endif %}
              <p class="text-xs">{{object.schedule.schedule_course.teacher.last_name}}</p>
              <p class="text-xs">{{object.schedule.schedule_course.course_short_name}}</p>
            </td>
            {% endfor %}
            <td class="p-2 border border-gray-400 text-center">
              <a href="{% url 'report-update-reporter' query_date forloop.counter %}">
                <p class="bg-yellow-600 p-1 rounded-md text-xs text-white font-semibold hover:bg-fuchsia-400 dark:hover:bg-gray-700 w-32 flex gap-4 justify-end items-center">Petugas Piket<span class="text-md p-1 bg-yellow-600 border-2 border-white rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"/>
                </svg></span>
                </p>
              </a>
              <p class="text-xs">{{data.first.reporter.last_name|default:"Belum input"}}</p>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>


</main>
{% endblock content %}